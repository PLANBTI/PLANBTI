<!DOCTYPE html>
<html layout:decorate="~{common/layout.html}" xmlns="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>교환 반품</title>
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
</head>
<body>
<main class="min-w-full" layout:fragment="main">

    <div class="flex flex-col border rounded-[20px] justify-content align-items mx-auto w-2/3 ">

        <div class="h-screen flex flex-col justify-center align-items gap-3 mt-3">
            <h1 class="text-center text-blue-800 text-3xl underline font-bold">제품 상세</h1>
            <table class="text-center border">
                <tr>
                    <th colspan="2" class="text-xl bg-gray-400 font-bold">제품</th>
                </tr>
                <tr>
                    <td class="text-xl border  py-2 font-bold">제품 이름</td>
                    <td class="text-bold text-xl border py-2  rounded-[20px] px-[10px] " id="orderId"
                        th:text="|${product.name}|"></td>
                </tr>
                <tr>
                    <td class="text-xl border  py-2 font-bold">제품 이름</td>
                    <td class="text-bold text-xl border py-2  rounded-[20px] px-[10px] " id="orderId"
                        th:text="|${product.content}|"></td>
                </tr>
                <tr>
                    <td class="text-xl border  py-2 font-bold">가격</td>
                    <td class="text-bold text-xl border py-2  rounded-[20px] px-[10px] " id="orderDate"
                        th:text="${product.price}"></td>
                </tr>
                <tr>
                    <td class="text-xl border  py-2 font-bold">남은 수량</td>
                    <td class="text-bold text-xl border py-2  rounded-[20px] px-[10px] " id="totalAmount"
                        th:text="${product.count}"></td>
                </tr>

            </table>
            <form id="customForm" method="POST" th:action="@{/product/order}" class="w-full max-w-lg flex flex-col justify-content align-items gap-3 mx-auto">
                <div class="inline-block my-4">
                    <div class="flex">
                        <input type="hidden" name="id" th:value="${product.id}">
                        <button type="button" class="bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-l" onclick="decrementCount()">-</button>
                        <input name="count" id="countInput" class="block appearance-none w-full bg-white border border-gray-400 hover:border-gray-500 px-4 py-2 rounded-none shadow leading-tight focus:outline-none focus:shadow-outline text-center" type="text" value="1" readonly>
                        <button type="button" class="bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-r" onclick="incrementCount()">+</button>
                    </div>
                </div>
                <button class="btn btn-outline btn-primary mt-4" onclick="requestBasket()" type="button">
                   장바구니에 담기
                </button>
                <button class="btn btn-outline btn-accent" onclick="requestOrder(this)">주문하기</button>
            </form>
            <ul role="list" id="reviewList" class="divide-y divide-gray-100 mt-3 flex-auto w-full">
                <li  th:each="review , i : ${reviewList}" class="flex justify-between gap-x-6 py-5">
                    <div class="flex gap-x-4 mx-2">
                        <!--TODO 이미지 넣기 review.image-->
                        <img class="h-12 w-12 flex-none rounded-full bg-gray-50" src="https://images.unsplash.com/photo-1494790108377-be9c29b29330?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80" alt="">
                        <div class="min-w-0 flex-auto">
                            <p class="mt-1  text-xl leading-5 text-gray-500" th:text="${review.title}">leslie.alexander@example.com</p>

                            <p class="mt-1  text-xs leading-5 text-gray-500" th:text="${review.content}">leslie.alexander@example.com</p>
                        </div>
                    </div>
                    <div class="flex flex-col items-end mx-2">
                        <p class="text-xs font-semi bold leading-6 text-gray-900" th:text="${review.username}" >Leslie Alexander</p>
                        <p class="leading-6 text-sm text-gray-900" th:text="|리뷰 날짜  ${#temporals.format(review.reviewDate,'yyyy-MM-dd')}|">Co-Founder / CEO</p>
                    </div>
                </li>
            </ul>
            <div class="flex justify-center items-center mx-auto mt-3 p-3">
                <button class="btn btn-outline btn-accent flex-grow-0 flex-shrink-0 w-full max-w-xs" onclick="moreReview()">리뷰 더보기</button>
            </div>
        </div>
        <script th:inline="javascript">
            let count = 1;
            const maxCount =/*[[${product.count}]]*/ 10;
            let offset = /*[[${reviewList.size+1}]]*/ 0;
            const productId =/*[[${product.id}]]*/ null;
        </script>
        <script th:src="@{/js/productDetail.js}"></script>
</main>
</body>
</html>